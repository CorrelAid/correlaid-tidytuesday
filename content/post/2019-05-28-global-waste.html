---
title: "Global Waste Exploratory Analysis"
output: html_document
author: 
  name: "Paul Meiners"
  twitter: "https://twitter.com/plmeiners"
date: 2019-05-28
categories: ["R"]
tags: ["rstats", "tidytuesday"]
---



<p>In this short post we start exploring the Global plastic waste dataset provided for the tidytuesday challange: <a href="https://github.com/rfordatascience/tidytuesday/tree/master/data/2019/2019-05-21" class="uri">https://github.com/rfordatascience/tidytuesday/tree/master/data/2019/2019-05-21</a></p>
<pre class="r"><code>library(tidyverse)
theme_set(theme_minimal())
library(ggrepel) # to move labels away from information in plots
library(viridis) # an easy to read color sheme 
library(scales) # to easily change the scales on the heatmaps</code></pre>
<div id="cleaning" class="section level1">
<h1>Cleaning</h1>
<p>Loading raw data from github</p>
<pre class="r"><code>coast_vs_waste &lt;- readr::read_csv(&quot;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-05-21/coastal-population-vs-mismanaged-plastic.csv&quot;)
mismanaged_vs_gdp &lt;- readr::read_csv(&quot;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-05-21/per-capita-mismanaged-plastic-waste-vs-gdp-per-capita.csv&quot;)
waste_vs_gdp &lt;- readr::read_csv(&quot;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-05-21/per-capita-plastic-waste-vs-gdp-per-capita.csv&quot;)</code></pre>
<p>Combine the three data sets</p>
<pre class="r"><code>data_all &lt;- coast_vs_waste %&gt;% 
  left_join(mismanaged_vs_gdp, by = c(&quot;Code&quot;, &quot;Year&quot;)) %&gt;%
  left_join(waste_vs_gdp, by = c(&quot;Code&quot;, &quot;Year&quot;))</code></pre>
<p>Rename columns (there are better ways to do this. You should check out the ‘janitor::clean_names’ function)</p>
<pre class="r"><code>names(data_all)[4:9] &lt;- c(&quot;waste_mis_total&quot;, &quot;coast_pop&quot;, &quot;total_pop&quot;, &quot;cntry&quot;, &quot;waste_mis_pcap&quot;, &quot;gdp_pcap&quot;)
names(data_all)[12] &lt;- c(&quot;waste_total_pcap&quot;)</code></pre>
<p>Select only necessary columns</p>
<pre class="r"><code>data_clean &lt;- select(data_all, waste_mis_total, cntry, waste_mis_pcap, coast_pop, gdp_pcap, waste_total_pcap, total_pop, Year, Code)
data_clean &lt;- mutate(data_clean, gdp = total_pop*gdp_pcap) %&gt;%
  mutate(waste_total_total = waste_total_pcap*total_pop)</code></pre>
</div>
<div id="exploratory-data-analysis" class="section level1">
<h1>Exploratory data analysis</h1>
<pre class="r"><code>ggplot(data = subset(data_clean, !is.na(coast_pop)), aes(x = coast_pop)) + 
  geom_bar(stat = &quot;bin&quot;)</code></pre>
<p><img src="/post/2019-05-28-global-waste_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Most countries have no costal population.</p>
<pre class="r"><code>ggplot(data = subset(data_clean, !is.na(waste_mis_pcap)), aes(x = waste_mis_pcap)) + 
  geom_bar(stat = &quot;bin&quot;)</code></pre>
<p><img src="/post/2019-05-28-global-waste_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Mismanaged waste per capita also follows a logarithmic distribution, a small number of countries has very high waste per capita.</p>
<pre class="r"><code>ggplot(data = subset(data_clean, !is.na(waste_mis_total)), aes(x = waste_mis_total, y = coast_pop)) + 
  geom_point()+
  geom_smooth()</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="/post/2019-05-28-global-waste_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>As it turns out, most global mismanaged plastic waste is produced by a few countries. However, a high coastal population does not automatically mean, that there is a lot of mismanaged waste.</p>
<div id="mismanaged-waste-per-capita-and-coastal-population" class="section level2">
<h2>Mismanaged waste per capita and coastal population</h2>
<pre class="r"><code>ggplot(data = subset(data_clean, !is.na(waste_mis_pcap)), aes(x = log1p(waste_mis_pcap), y = log(coast_pop))) + 
  geom_point(aes(color = gdp_pcap), size = 3) +
  geom_text_repel(aes(label = ifelse(log1p(waste_mis_pcap)&gt;0.12,as.character(cntry),&#39;&#39;)),
                   box.padding = 0.35, 
                   point.padding = 0.5,
                   segment.color = &#39;grey50&#39;) +
  scale_color_viridis()</code></pre>
<p><img src="/post/2019-05-28-global-waste_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Looking at the mismanaged waste per capita and the amount of coastal population, we can identify a number of island countries with very high levels of mismanaged waste per capita. Generally, these countries have rather low GDP per capita levels. High GDP per capita countries appear to have comparatively low levels of mismanaged waste per capita.</p>
<pre class="r"><code>ggplot(data=subset(data_clean, !is.na(waste_mis_pcap)), aes(x = log(gdp_pcap), y = log(waste_mis_total))) + 
  geom_point(aes(color = waste_mis_pcap), size = 3) +
  geom_text_repel(aes(label = ifelse(log1p(waste_mis_pcap)&gt;0.12,as.character(cntry),&#39;&#39;)),
                  box.padding = 0.35, 
                  point.padding = 0.5,
                  segment.color = &#39;grey50&#39;) +
  geom_smooth()+
  scale_color_viridis()</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="/post/2019-05-28-global-waste_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>The countries with high waste per capita are distributed across the spectrum, suggesting other reasons for their high waste levels. Maybe Island countries are just more affected (per capita) by waste that others produce. The relationship between gdp and waste is nonlinear. Higher GDP per capita seems to increase total waste for the first half of the distriution. For the second half of the distribution, higher GDP per capita is negatively associated with total waste.</p>
</div>
</div>
<div id="integrating-time-effects" class="section level1">
<h1>Integrating time effects</h1>
<p>We only have data on total waste and mismanaged waste for 2010. But the time-series data on population and GDP growth can still be interesting. Maybe we can divide countries into “stalbe, low GDP/population”fast growing&quot; and “stable high GDP/population” categories? The theory being that a period of high GDP or population could create higher levels of mismanaged waste in 2010 because waste control can’t “keep up” with the new demand.</p>
<p>First we create the changes in percentage compared to last year: GDP per capita change compared to last year:</p>
<pre class="r"><code>data_clean &lt;- data_clean %&gt;%
  filter(!is.na(gdp_pcap)) %&gt;%
  group_by(cntry) %&gt;%
  arrange(Year, .by_group = TRUE) %&gt;%
  mutate(gdp_pcap_change = (gdp_pcap/lag(gdp_pcap) - 1) * 100)</code></pre>
<p>Population change compared to last year:</p>
<pre class="r"><code>data_clean &lt;- data_clean %&gt;%
  filter(!is.na(total_pop)) %&gt;%
  group_by(cntry) %&gt;%
  arrange(Year, .by_group = TRUE) %&gt;%
  mutate(total_pop_change = (total_pop/lag(total_pop) - 1) * 100)</code></pre>
<p>Now we can create a Heatmap of the changes in population and GDP growth. Then we sort the heatmap for mismanaged waste in total or for mismanaged waste per capita. If there are any obvious trends, they could be visible without having to use any inferential statistics. The human brain is quite good at pattern recognition.</p>
<p>We need to replace missing observations of waste in order to sort the heatmap.</p>
<pre class="r"><code>data_time &lt;- data_clean %&gt;% 
  group_by(cntry) %&gt;% 
  fill(waste_mis_pcap, waste_mis_total, waste_total_total) %&gt;% #default direction down
  fill(waste_mis_pcap, waste_mis_total, waste_total_total, .direction = &quot;up&quot;)</code></pre>
<p>A heatmap filled by population change and sorted by mismanaged waste per capita. You can mostly ignore the labels on the Y axis. If youre looking closely, you’ll see that the sorting worked. The small island countries with high mismanaged waste per capita appear at the bottom.</p>
<pre class="r"><code>ggplot(data = data_time, aes(x = Year, y = reorder(cntry, -waste_mis_pcap), z = total_pop_change)) + 
  geom_tile(aes(fill = total_pop_change)) +
  scale_fill_viridis(limits = c(-3, 10),oob = scales::squish)</code></pre>
<p><img src="/post/2019-05-28-global-waste_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>A heatmap filled by population change and sorted by total mismanaged waste</p>
<pre class="r"><code>ggplot(data = data_time, aes(x = Year, y = reorder(cntry, -waste_total_total), z = gdp_pcap_change)) + 
  geom_tile(aes(fill = total_pop_change)) +
  scale_fill_viridis(limits = c(-3, 10),oob = scales::squish)</code></pre>
<p><img src="/post/2019-05-28-global-waste_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>A heatmap filled by gdp change and sorted by mismanaged waste per capita</p>
<pre class="r"><code>ggplot(data = data_time, aes(x = Year, y = reorder(cntry, -waste_mis_pcap), z = gdp_pcap_change)) + 
  geom_tile(aes(fill = gdp_pcap_change)) +
  scale_fill_viridis(limits = c(-30, 30),oob = scales::squish)</code></pre>
<p><img src="/post/2019-05-28-global-waste_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>A heatmap filled by gdp change and sorted by total mismanaged waste</p>
<pre class="r"><code>ggplot(data = data_time, aes(x = Year, y = reorder(cntry, -waste_total_total), z = gdp_pcap_change)) + 
  geom_tile(aes(fill = gdp_pcap_change)) +
  scale_fill_viridis(limits = c(-30, 30),oob = scales::squish)</code></pre>
<p><img src="/post/2019-05-28-global-waste_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>The heatmaps do look pretty, but I don’t think we can clearly see the pattern hypothesized before. The only striking effect is the change in GDP from 2008 to 2009. I would assume that is the global financial crisis that left it’s mark on the data.</p>
</div>
